# TDMS adquisition with triggers

The idea is make an acquisition in continuous mode using a trigger to start and another trigger to pause the acquisition. In this way, the acquisition can be synchronized with another device, or you can make a measurement during a specific time.   
To do that, we need to configure the **start trigger** to start the acquisition and configure the **pause trigger** to stop the acquisition by hardware. But because this board not support all types of the trigger pause, and it doesn't support an analog start and pause trigger at the same task. I use digital edge start trigger and digital level pause trigger (edge is not supported).    
The **pause trigger** is a condition that when is active stop the acquisition and when is deactivated allow the acquisition. If you make a large acquisition and activate and deactivate the trigger a few times, the data acquired when is deactivated will be appended and returned. Be careful with the timeout of the acquisition method, if the paused time is greater than the timeout you can obtain a timeout error.    
To achieve this I need a special pulse trigger that have a rising edge and maintains a high level for a certain time and after have a falling edge and maintain a lower level. This pulse must be generated by hardware to give an accurate time duration for that I used a Counter Output, in the following images you can see the signal acquired and trigger pulse acquired.  
Trigger inputs the board does not allow route the start and pause trigger to the same terminal but to have a single trigger pulse input in [BNC-2110](https://www.ni.com/docs/en-US/bundle/bnc-2110-getting-started/resource/372121f.pdf) I route the triggers to deferments PFI and connect this to USER2 in terminal block retaining screw in this way I have the two PFI at the same BNC in user-defined signals USER2. As the task does not wait for the pause trigger until after receiving the start trigger, this connection works. 

## Adquisition with PCI board
![alt text](https://github.com/juliancabaleiro/nidaqmx-python-examples/blob/main/doc/images/tdms_co_pci.png)
## Adquisition with oscilloscope
![alt text](https://github.com/juliancabaleiro/nidaqmx-python-examples/blob/main/doc/images/tdms_co_scope.png)

## Sampling frecuency

I make some measurement changing the sampling rate and discover that the total acquisition point not are the expected. I try changing acquisition time, channels, buffer size, sleep time and obtain similar results. In my opinion the clock are not optimized and from some frequencies generates this phenomenon.
Similar issue occurs in [nyspire NI-DAQmx Python Tutorial](https://nspyre.readthedocs.io/en/latest/guides/ni-daqmx.html) for digital inputs.

  fs [samp/s] -> #samples in 10 s  
  500_000  -> 5_000_000  
  600_000 -> 6_060_608  
  700_000 -> 7_142_857  
  790_000 -> 8_000_000  
  800_000 -> 8_000_000  
  900_000 -> 9_090_908  
1_000_000 -> 10_000_000  
